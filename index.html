<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>GrandRP Finder</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0f0f0f; color: #eee; text-align: center; padding: 40px; }
        .main-card { background: #1a1a1a; border: 1px solid #333; padding: 30px; border-radius: 12px; display: inline-block; width: 350px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        input { width: 90%; padding: 12px; margin: 10px 0; border-radius: 6px; border: 1px solid #444; background: #222; color: white; }
        button { width: 95%; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; margin: 5px 0; transition: 0.2s; }
        .btn-search { background: #ff4d4d; color: white; }
        .btn-list { background: #333; color: #ccc; }
        button:hover { opacity: 0.8; transform: scale(0.98); }
        #output { margin-top: 20px; text-align: left; max-height: 300px; overflow-y: auto; border-top: 1px solid #333; padding-top: 15px; }
        .player-row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #222; font-size: 14px; }
        .id-tag { color: #ff4d4d; font-weight: bold; }
    </style>
</head>
<body>

<div class="main-card">
    <h2 style="margin-top:0">GrandRP Finder</h2>
    <p style="font-size: 12px; color: #888;">Wpisz ID serwera z linku cfx.re (np. 6y6m6y)</p>
    <input type="text" id="serverCfx" placeholder="Server ID (np. 6y6m6y)" value="6y6m6y">
    <input type="number" id="searchId" placeholder="Wpisz ID gracza do znalezienia">
    
    <button class="btn-search" onclick="findPlayer()">SZUKAJ GRACZA</button>
    <button class="btn-list" onclick="toggleAll()">POKAŻ / UKRYJ LISTĘ</button>

    <div id="output"></div>
</div>

<script>
    let players = [];
    let visible = false;

    async function getData() {
        const sID = document.getElementById('serverCfx').value;
        const out = document.getElementById('output');
        try {
            // Używamy corsproxy, bo FiveM blokuje bezpośrednie zapytania ze stron www
            const res = await fetch(`https://corsproxy.io/?https://servers-frontend.fivem.net/api/servers/single/${sID}`);
            const json = await res.json();
            return json.Data.players;
        } catch (e) {
            out.innerHTML = "<span style='color:red'>Błąd: Nie znaleziono serwera lub brak połączenia.</span>";
            return [];
        }
    }

    async function findPlayer() {
        const id = document.getElementById('searchId').value;
        const out = document.getElementById('output');
        if(!id) return alert("Wpisz ID!");
        
        out.innerHTML = "Szukanie...";
        players = await getData();
        const p = players.find(x => x.id == id);
        
        if(p) {
            out.innerHTML = `<div class='player-row'><span>NICK:</span> <strong>${p.name}</strong></div>`;
        } else {
            out.innerHTML = "Nie znaleziono takiego gracza online.";
        }
    }

    async function toggleAll() {
        const out = document.getElementById('output');
        visible = !visible;
        if(!visible) { out.innerHTML = ""; return; }
        
        out.innerHTML = "Ładowanie listy...";
        players = await getData();
        out.innerHTML = `<strong>Online: ${players.length}</strong><br><br>`;
        players.forEach(p => {
            out.innerHTML += `<div class='player-row'><span class='id-tag'>[${p.id}]</span> <span>${p.name}</span></div>`;
        });
    }
</script>

</body>
</html>
